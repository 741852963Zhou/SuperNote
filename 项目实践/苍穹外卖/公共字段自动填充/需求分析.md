# 1. 需求分析：公共字段自动填充

## 1. 痛点分析 (Why)

在开发 "苍穹外卖" 项目时，发现数据库中**几乎所有表** (如 `employee`, `category`, `dish`, `setmeal` 等) 都包含以下四个字段：

- `create_time` (创建时间)
- `update_time` (修改时间)
- `create_user` (创建人ID)
- `update_user` (修改人ID)

这就导致在 `Service` 层的**所有“新增”和“修改”**方法中，都必须编写重复的代码来手动为这四个字段赋值。

### 重复的代码（示例）

以 `EmployeeServiceImpl` 为例，在 `addEmployee` 方法中，我们**被迫**要写如下逻辑：

```java
    @Override
    public void addEmployee(EmployeeDTO employeeDTO) {
        Employee employee = new Employee();
        BeanUtils.copyProperties(employeeDTO, employee);        
        employee.setPassword(DigestUtils.md5DigestAsHex
                            (PasswordConstant.
                            DEFAULT_PASSWORD.getBytes()));
        employee.setStatus(StatusConstant.ENABLE);
        
        // ===================================
        // ==     这里是重复的“样板代码”     ==
        // ===================================
        // employee.setCreateTime(LocalDateTime.now());
        // employee.setUpdateTime(LocalDateTime.now());
        //
        // employee.setCreateUser(BaseContext.getCurrentId());
        // employee.setUpdateUser(BaseContext.getCurrentId());

        employeeMapper.insert(employee);
    }
````

在 `CategoryServiceImpl` 的 `save` 和 `update` 方法中，也存在**完全相同**的重复代码：

```java
    public void save(CategoryDTO categoryDTO) {
        //...
        设置创建时间、修改时间、创建人、修改人
        category.setCreateTime(LocalDateTime.now());
        category.setUpdateTime(LocalDateTime.now());
        category.setCreateUser(BaseContext.getCurrentId());
        category.setUpdateUser(BaseContext.getCurrentId());

        categoryMapper.insert(category);
    }
```

## 2. 需求目标 (Goal)

1. **消除重复**：将这些重复的赋值逻辑从 `Service` 层**彻底移除**。
    
2. **自动化**：让框架在执行 `INSERT` 或 `UPDATE` 的 SQL 语句之前，**自动**为这四个字段赋值。
    
3. **解耦**：业务代码（如 `EmployeeServiceImpl`）只关心业务逻辑，不再关心 `createTime` 这种非业务的公共字段。